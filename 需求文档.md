# Tetris

棋盘大小

​	20x10

分模块

​	编译支持RETURN 和 CALL（使用JRRA和JALR?）

​	需要DEFINE定义常量吗

当前整个图的信息存储

​	不再借助于VGA的接口，这是用户程序的事情，自己用自己存（例如8000开头的连续？）

当前方块的存储方式

​	16位的数据刚好4*4的正方形，为1代表有格子否则没有

​	存到栈里面

​	本质上的方块类型只有有限的十几种，将这十几个状态写死在栈里（例如9000开头的连续？）

​	每个方块记录一个当前左上角和方块类型（需要用的时候再从栈里面取出来）

旋转的实现

​	写死

​	每种类型的方块旋转之后也是对应一个类型（数字），可以存到栈里，到时候直接访问？（例如A000开头的连续？）

判断合法性

​	主要是旋转是否合法（只要判断所有为1的位置是否越界以及是否已经有字符）

​	传入两个参数，分别是当前的左上角，和当前的状态

​	然后调用函数判断合法性，并返回值，不合法则不旋转，否则修改当前方块的状态

调用函数如何方便的做？

​	不用栈（因为栈涉及到入栈，出栈，而这个工作谁来做，其实很麻烦，得双方都约定好）

​	在一个固定的起始位置（例如B000开头）依次存放第一个参数，第二个参数...

​	返回值直接放到B000里

颜色？

​	写死每个方块的图片（或者单纯的正在下落的是随机的  下落之后全部变成一个色（好像实现起来有点困难））

显示

​	固定频率向Api发送整个图的信息（还是有更改更新图的信息？）感觉后者靠谱些

延迟

​	卡住就行了，根据主频执行若干条无意义的指令

判断合法事件

​	传入新的状态，判断是否和已有的冲突

自由下落事件

​	判断能否下落，能的话下落，不能的话将当前方块写入8000开头的那块儿区域，然后随机出现一个新的方块

键盘事件

​	每卡固定时间判断一下键盘事件

​	上	判断能否旋转

​	左右     判断能否移动

​	下	 瞬间移动到最下面（本质上是执行自由下落事件，直到不能下落，所以要不把自由下落写成一个函数返回一个值表示是否成功？）	

消行

​	下落事件返回值为1之后，从最下面依次判断，满了一行就把整个图下移并显示给VGA

增加显示分数的功能？

~~随时间下落越来越快？~~

关于如何写给VGA

​	坐标如何表示

参考资料

​	https://blog.csdn.net/wenqiang1208/article/details/71244843/